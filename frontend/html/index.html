<!DOCTYPE html>

<html>
  <head>
    <base href="/">

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache">
    <meta meta-equiv="Expires" content="0">
    <meta http-equiv="Pragma" CONTENT="no-cache">

    <link rel="shortcut icon" href="logo.jpg">

    <title></title>
  </head>

  <body>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">

    <!-- display the application -->
    <div id="app" style="height: 100%; width: 100%;"></div>

    <!-- load my fp library -->
    <script src="common.js"></script>

    <!-- load cyclejs -->
    <script src="node_modules/xstream/dist/xstream.js"></script>
    <script src="node_modules/@cycle/xstream-run/dist/cycle.js"></script>
    <script src="node_modules/@cycle/dom/dist/cycle-dom.js"></script>
    <script src="node_modules/@cycle/http/dist/cycle-http-driver.js"></script>

    <script type="text/javascript">
      const xs = xstream.default
      const {
        makeDOMDriver,
        a,        abbr,     address,  area,
        article,  aside,    audio,    b,
        base,     bdi,      bdo,      blockquote,
        body,     br,       button,   canvas,
        caption,  cite,     code,     col,
        colgroup, dd,       del,      dfn,
        dir,      div,      dl,       dt,
        em,       embed,    fieldset, figcaption,
        figure,   footer,   form,     head,
        header,   hgroup,   hr,       html,
        i,        iframe,   img,      input,
        ins,      kbd,      keygen,   label,
        legend,   li,       link,     map,
        mark,     menu,     meta,     nav,
        noscript, object,   ol,       optgroup,
        option,   p,        param,    pre,
        progress, q,        rp,       rt,
        ruby,     s,        samp,     script,
        section,  select,   small,    source,
        span,     strong,   style,    sub,
        sup,      table,    tbody,    td,
        textarea, tfoot,    th,       thead,
        title,    tr,       u,        ul,
        video,
      } = CycleDOM
      const {makeHTTPDriver} = CycleHTTPDriver
      let cfg = (() => {
        var request = new XMLHttpRequest ()
        request.open ('GET', '/cfg', false)
        request.send (null)
        return eval ('(' + request.responseText + ')')
      }) ()
      var get_logger = x => ! cfg.prod ? y => console.log (x + ': ' + y) : _ => {}
      // set window title
      window.document.title = cfg.title
    </script>

    <!-- load app -->
    <script src="app.js"></script>

    <script type="text/javascript">
      Cycle.run (main, {
        DOM: makeDOMDriver ('#app'),
        HTTP: makeHTTPDriver (),
      })
    </script>
  </body>
</html>
